<%= render 'shared/navbar' %>
<div class="border">
  <div class="profile-info">
    <% if @user.prof_pic.present? %>
      <img src="<%=@user.pic_url%>" class="prof-pic edit-pic">
      <%# <%= cl_image_tag(@user.prof_pic.key, crop: :fill, class: "prof-pic edit-pic") %>
      <%# <%= image_tag(@user.prof_pic, class: "prof-pic edit-pic") %>
      <% else %>
      <img src="https://snacky-assets.s3.eu-west-2.amazonaws.com/haribo-prof.jpeg", class="prof-pic edit-pic">
    <% end %>
    <div class="profile-text">
      <% if @posts.count == 0 %>
      <h3 class="welcome-profile text-center"><%= @user.first_name %>hasn't posted yet! üßê</h3>
      <% elsif @posts.count == 1 %>
      <h3 class="welcome-profile text-center"><%= @user.first_name %> has made 1 post</h3>
      <% else %>
      <h3 class="welcome-profile text-center"><%= @user.first_name %> has made <%= @posts.count%> posts</h3>
      <% end %>
      <p class="text-right">Snacky contributer since <%=@user.created_at.strftime("%B %d, %Y") %></p>
    </div>
  </div>
  <% if @markers.count == 0 %>
  <p>Nothing to see here!</p>
  <% else %>
  <div class="map-container">
    <h1 class="your-snack-map text-center"><%= @user.first_name %>'s snack map</h1>
    <div class="" style="width: 100%; height: 300px; border: 0.5px solid black; z-index:0"
      data-controller="map"
      data-map-page-value="profile"
      data-map-markers-value="<%= @markers.to_json %>"
      data-map-api-key-value="<%= ENV['MAPBOX_API_KEY'] %>">
    </div>
  </div>
  <% end %>

  <div class="all-posts">
    <% @posts.each do |post|%>
      <div class="post-container-show">
        <div class="image">
          <img src="<%=post.image_url%>" class="post-image">
        </div>
        <div class="post-text">
          <%= link_to post_path(post.id) do %>
          <h3 class="post-title mt-0"><%= post.title %></h3>
          <% end %>
          <div class="stars">
          <% case post.rating %>
          <% when 1 %>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 2%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 3%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 4%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 5%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 6%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 7%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 8%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 9%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star empty-star"></i>
          <% when 10%>
            <i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i><i class="fa-solid fa-star star"></i>
          <% end %>
          </div>
          <div class="review-text">
            <p><strong>review: </strong><%= post.review %></p>
            <p><strong>brand: </strong><%= post.brand %></p>
            <p><strong>country: </strong><%= post.country_name %></p>
          </div>
          <p class="small-p mt-10 mb-10">posted <%= post.created_at.strftime("%B %d, %Y") %></p>

          <div class="likes-div">
              <div class="likes-n-comments">
                <p><i class="fa-solid fa-heart red"></i> <%= post.post_likes.count %></p>
                <p><i class="fa-solid fa-comment-dots comment"></i> <%= post.post_comments.count %></p>
              </div>
              <div class="tags-container">
                <% post.post_tags.each do |tag| %>
                <p class="tag small-p"><%= tag.tag %></p>
                <% end %>
              </div>
            </div>
        </div>
      </div>
      <% end %>
  </div>
</div>
